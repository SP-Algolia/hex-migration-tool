"These are some initial mappings between Redshift and Databricks functions. While this list covers common conversions, additional information may be needed based on specific query patterns and use cases.",,,,
SNO,Redshift Function,Purpose,Databricks Equivalent,Example
1,"DATEADD(day, n, date_col)",Add days,"date_add(date_col, n)",
2,"DATEADD(day, -n, date_col)",Subtract days,"date_sub(date_col, n)",
3,"DATEADD(month, n, date_col)",Add months,"add_months(date_col, n)",
4,"DATEDIFF(day, date1, date2)",Difference in days,"datediff(date2, date1) ← note the reversed args",
5,"DATE_TRUNC('day', date_col)",Truncate to day,"date_trunc('DAY', date_col)",
6,"DATE_TRUNC('month', date_col)",Truncate to month,"date_trunc('MONTH', date_col)",
7,"DATE_TRUNC('year', date_col)",Truncate to year,"date_trunc('YEAR', date_col)",
8,"TO_CHAR(date_col, 'YYYY-MM-DD')",Format as string,"date_format(date_col, 'yyyy-MM-dd')",
9,"TO_DATE('2023-01-01', 'YYYY-MM-DD')",Parse string to date,"to_date('2023-01-01', 'yyyy-MM-dd')",
10,VARCHAR,Text,Uses STRING as the default type for text,
11,"JSON_EXTRACT_PATH_TEXT(json, path)",Extracts string from JSON at specified path,"get_json_object(json_col, '$.path')",
12,"JSON_EXTRACT_ARRAY_ELEMENT_TEXT(json_array, index)",Gets array element from JSON,"get_json_object(json_array, '$[index]') (or use from_json)",
13,IS_VALID_JSON_ARRAY(json),Validates if input is a valid JSON array,"Use: try(from_json(json, 'array<type>')) IS NOT NULL",
14,IS_VALID_JSON(json),Validates if string is valid JSON,"Use: try(from_json(json, 'map<string,string>')) IS NOT NULL",
15,JSON_PARSE(json),Parses a JSON string into Redshift's SUPER type,"from_json(json_col, schema) — schema must be specified",
16,"SPLIT_TO_ARRAY(str, delimiter)",Splits string into array,"split(str_col, delimiter)",
17,"LISTAGG(col, delimiter)",String aggregation (group_concat),"concat_ws(delimiter, collect_list(col))",
18,"DATEPART(field, date)","Extracts part of date (e.g. year, month)","year(date), month(date), day(date), or date_format(date, 'pattern')",
19,"CONVERT(type, expression)",Converts between types,CAST(expression AS type) or TRY_CAST() in newer Databricks,
20,CURRENT_DATE,Current date,current_date(),
21,CURRENT_TIMESTAMP,Current timestamp,current_timestamp(),
22,EXTRACT(YEAR FROM date_col),Extract year,year(date_col),
23,EXTRACT(MONTH FROM date_col),Extract month,month(date_col),
24,EXTRACT(DAY FROM date_col),Extract day,day(date_col) or dayofmonth(date_col),
25,EXTRACT(DOW FROM date_col),Extract weekday,dayofweek(date_col) (1 = Sunday),
26,EXTRACT(HOUR FROM timestamp_col),Extract hour,hour(timestamp_col),
27,EXTRACT(MINUTE FROM timestamp_col),Extract minute,minute(timestamp_col),
28,EXTRACT(SECOND FROM timestamp_col),Extract second,second(timestamp_col),
29,CAST(col AS DATE),Cast to date,CAST(col AS DATE) or to_date(col),
30,CAST(col AS TIMESTAMP),Cast to timestamp,CAST(col AS TIMESTAMP) or to_timestamp(col),
31,EXTRACT(WEEK FROM date_col),Week of year,weekofyear(date_col),
32,EXTRACT(QUARTER FROM date_col),Quarter,quarter(date_col),